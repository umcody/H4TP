{"ast":null,"code":"function ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport { useEffect, useMemo, useState, useRef, useCallback } from 'react';\nimport highlightReducer from './highlightReducer';\nimport getDisplayValue from './lib/getDisplayValue';\nimport flattenOptions from './lib/flattenOptions';\nimport groupOptions from './lib/groupOptions';\nimport getNewValue from './lib/getNewValue';\nimport getOption from './lib/getOption';\nimport doSearch from './search';\nexport default function useSelectSearch({\n  value: defaultValue = null,\n  disabled = false,\n  multiple = false,\n  search: canSearch = false,\n  fuse = false,\n  options: defaultOptions,\n  onChange = () => {},\n  getOptions = null,\n  allowEmpty = true,\n  closeOnSelect = true,\n  closable = true\n}) {\n  const ref = useRef(null);\n  const flatDefaultOptions = useMemo(() => flattenOptions(defaultOptions), [defaultOptions]);\n  const [state, setState] = useState({\n    flat: [],\n    addedOptions: [],\n    value: defaultValue,\n    search: '',\n    focus: false,\n    searching: false,\n    highlighted: -1,\n    changed: false\n  });\n  const {\n    flat,\n    addedOptions,\n    value,\n    search,\n    focus,\n    searching,\n    highlighted\n  } = state;\n  const option = useMemo(() => {\n    let newOption = getOption(value, [...flatDefaultOptions, ...addedOptions]);\n\n    if (!newOption && !allowEmpty && !multiple) {\n      [newOption] = flatDefaultOptions;\n    }\n\n    return newOption;\n  }, [value, flatDefaultOptions, addedOptions, allowEmpty, multiple]);\n  const options = useMemo(() => groupOptions(flat), [flat]);\n  const displayValue = useMemo(() => getDisplayValue(option), [option]);\n  const onBlur = useCallback(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      focus: false,\n      search: '',\n      flat: flatDefaultOptions,\n      highlighted: -1\n    }));\n\n    if (ref.current) {\n      ref.current.blur();\n    }\n  }, [flatDefaultOptions, ref]);\n\n  const setFocus = newFocus => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    focus: newFocus\n  }));\n\n  const onClick = () => setFocus(!focus);\n\n  const onFocus = () => setFocus(true);\n\n  const onSelect = useCallback(id => {\n    setState(prevState => {\n      const {\n        flat: prevFlat,\n        highlighted: prevHighlighted\n      } = prevState; // eslint-disable-next-line no-underscore-dangle\n\n      const item = id ? prevFlat.find(i => i._id === id) : prevFlat[prevHighlighted];\n\n      if (!item) {\n        return prevState;\n      }\n\n      const values = getNewValue(item.value, prevState.value, multiple);\n      const newOptions = getOption(values, prevFlat);\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        addedOptions: multiple ? newOptions : [newOptions],\n        value: values,\n        changed: [values, newOptions]\n      });\n    });\n  }, [multiple]);\n  const onMouseDown = useCallback(e => {\n    if (!closeOnSelect) {\n      e.preventDefault();\n    }\n\n    onSelect(e.currentTarget.value);\n  }, [onSelect, closeOnSelect, multiple]);\n  const onKeyDown = useCallback(e => {\n    const {\n      key\n    } = e;\n\n    if (key === 'ArrowDown' || key === 'ArrowUp') {\n      e.preventDefault();\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        highlighted: highlightReducer(oldState.highlighted, {\n          key,\n          options: oldState.flat\n        })\n      }));\n    }\n  }, []);\n  const onKeyPress = useCallback(({\n    key\n  }) => {\n    if (key === 'Enter') {\n      onSelect();\n\n      if (closable && closeOnSelect) {\n        onBlur();\n      }\n    }\n  }, [onSelect, multiple, closeOnSelect, onBlur]);\n  const onKeyUp = useCallback(({\n    key\n  }) => {\n    if (key === 'Escape') {\n      onBlur();\n    }\n  }, [onBlur]);\n\n  const onSearch = ({\n    target\n  }) => {\n    const {\n      value: inputVal\n    } = target;\n    const newState = {\n      search: inputVal\n    };\n    let searchableOption = flatDefaultOptions;\n\n    if (getOptions && inputVal.length) {\n      newState.searching = true;\n      searchableOption = getOptions(inputVal);\n    }\n\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), newState));\n    Promise.resolve(searchableOption).then(foundOptions => {\n      let newOptions = foundOptions;\n\n      if (inputVal.length) {\n        newOptions = doSearch(inputVal, foundOptions, fuse);\n      }\n\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        flat: newOptions === false ? foundOptions : newOptions,\n        searching: false\n      }));\n    }).catch(() => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions,\n      searching: false\n    })));\n  };\n\n  const valueProps = {\n    tabIndex: '0',\n    readOnly: !canSearch,\n    onChange: canSearch ? onSearch : null,\n    disabled,\n    onMouseDown: onClick,\n    onBlur,\n    onFocus,\n    onKeyPress,\n    onKeyDown,\n    onKeyUp,\n    ref\n  };\n  const optionProps = useMemo(() => ({\n    tabIndex: '-1',\n    onMouseDown,\n    onKeyDown,\n    onKeyPress,\n    onBlur\n  }), [onMouseDown, onKeyDown, onKeyPress, onBlur]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      value: defaultValue\n    }));\n  }, [defaultValue]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions\n    }));\n  }, [flatDefaultOptions]);\n  useEffect(() => {\n    if (state.changed !== false) {\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        changed: false\n      }));\n      onChange(...state.changed);\n    }\n  }, [state.changed, onChange]);\n  return [{\n    value: option,\n    highlighted,\n    options,\n    disabled,\n    displayValue,\n    focus,\n    search,\n    searching\n  }, valueProps, optionProps, newValue => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    value: newValue\n  }))];\n}","map":{"version":3,"sources":["/Users/codyum/Desktop/Github/h4tp/node_modules/react-select-search/dist/esm/useSelect.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","useEffect","useMemo","useState","useRef","useCallback","highlightReducer","getDisplayValue","flattenOptions","groupOptions","getNewValue","getOption","doSearch","useSelectSearch","defaultValue","disabled","multiple","search","canSearch","fuse","options","defaultOptions","onChange","getOptions","allowEmpty","closeOnSelect","closable","ref","flatDefaultOptions","state","setState","flat","addedOptions","focus","searching","highlighted","changed","option","newOption","displayValue","onBlur","oldState","current","blur","setFocus","newFocus","onClick","onFocus","onSelect","id","prevState","prevFlat","prevHighlighted","item","find","_id","values","newOptions","onMouseDown","e","preventDefault","currentTarget","onKeyDown","onKeyPress","onKeyUp","onSearch","inputVal","newState","searchableOption","Promise","resolve","then","foundOptions","catch","valueProps","tabIndex","readOnly","optionProps","newValue"],"mappings":"AAAA,SAASA,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AAAE,MAAIC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYF,MAAZ,CAAX;;AAAgC,MAAIG,MAAM,CAACC,qBAAX,EAAkC;AAAE,QAAIC,OAAO,GAAGF,MAAM,CAACC,qBAAP,CAA6BJ,MAA7B,CAAd;AAAoD,QAAIC,cAAJ,EAAoBI,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe;AAAE,aAAOJ,MAAM,CAACK,wBAAP,CAAgCR,MAAhC,EAAwCO,GAAxC,EAA6CE,UAApD;AAAiE,KAAjG,CAAV;AAA8GP,IAAAA,IAAI,CAACQ,IAAL,CAAUC,KAAV,CAAgBT,IAAhB,EAAsBG,OAAtB;AAAiC;;AAAC,SAAOH,IAAP;AAAc;;AAErV,SAASU,aAAT,CAAuBC,MAAvB,EAA+B;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;;AAAuD,QAAIA,CAAC,GAAG,CAAR,EAAW;AAAEf,MAAAA,OAAO,CAACI,MAAM,CAACc,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAUC,GAAV,EAAe;AAAEC,QAAAA,eAAe,CAACP,MAAD,EAASM,GAAT,EAAcF,MAAM,CAACE,GAAD,CAApB,CAAf;AAA4C,OAAnG;AAAuG,KAApH,MAA0H,IAAIhB,MAAM,CAACkB,yBAAX,EAAsC;AAAElB,MAAAA,MAAM,CAACmB,gBAAP,CAAwBT,MAAxB,EAAgCV,MAAM,CAACkB,yBAAP,CAAiCJ,MAAjC,CAAhC;AAA4E,KAApH,MAA0H;AAAElB,MAAAA,OAAO,CAACI,MAAM,CAACc,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAUC,GAAV,EAAe;AAAEhB,QAAAA,MAAM,CAACoB,cAAP,CAAsBV,MAAtB,EAA8BM,GAA9B,EAAmChB,MAAM,CAACK,wBAAP,CAAgCS,MAAhC,EAAwCE,GAAxC,CAAnC;AAAmF,OAApI;AAAwI;AAAE;;AAAC,SAAON,MAAP;AAAgB;;AAEthB,SAASO,eAAT,CAAyBI,GAAzB,EAA8BL,GAA9B,EAAmCM,KAAnC,EAA0C;AAAE,MAAIN,GAAG,IAAIK,GAAX,EAAgB;AAAErB,IAAAA,MAAM,CAACoB,cAAP,CAAsBC,GAAtB,EAA2BL,GAA3B,EAAgC;AAAEM,MAAAA,KAAK,EAAEA,KAAT;AAAgBhB,MAAAA,UAAU,EAAE,IAA5B;AAAkCiB,MAAAA,YAAY,EAAE,IAAhD;AAAsDC,MAAAA,QAAQ,EAAE;AAAhE,KAAhC;AAA0G,GAA5H,MAAkI;AAAEH,IAAAA,GAAG,CAACL,GAAD,CAAH,GAAWM,KAAX;AAAmB;;AAAC,SAAOD,GAAP;AAAa;;AAEjN,SAASI,SAAT,EAAoBC,OAApB,EAA6BC,QAA7B,EAAuCC,MAAvC,EAA+CC,WAA/C,QAAkE,OAAlE;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,OAAOC,cAAP,MAA2B,sBAA3B;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,OAAOC,SAAP,MAAsB,iBAAtB;AACA,OAAOC,QAAP,MAAqB,UAArB;AACA,eAAe,SAASC,eAAT,CAAyB;AACtCf,EAAAA,KAAK,EAAEgB,YAAY,GAAG,IADgB;AAEtCC,EAAAA,QAAQ,GAAG,KAF2B;AAGtCC,EAAAA,QAAQ,GAAG,KAH2B;AAItCC,EAAAA,MAAM,EAAEC,SAAS,GAAG,KAJkB;AAKtCC,EAAAA,IAAI,GAAG,KAL+B;AAMtCC,EAAAA,OAAO,EAAEC,cAN6B;AAOtCC,EAAAA,QAAQ,GAAG,MAAM,CAAE,CAPmB;AAQtCC,EAAAA,UAAU,GAAG,IARyB;AAStCC,EAAAA,UAAU,GAAG,IATyB;AAUtCC,EAAAA,aAAa,GAAG,IAVsB;AAWtCC,EAAAA,QAAQ,GAAG;AAX2B,CAAzB,EAYZ;AACD,QAAMC,GAAG,GAAGvB,MAAM,CAAC,IAAD,CAAlB;AACA,QAAMwB,kBAAkB,GAAG1B,OAAO,CAAC,MAAMM,cAAc,CAACa,cAAD,CAArB,EAAuC,CAACA,cAAD,CAAvC,CAAlC;AACA,QAAM,CAACQ,KAAD,EAAQC,QAAR,IAAoB3B,QAAQ,CAAC;AACjC4B,IAAAA,IAAI,EAAE,EAD2B;AAEjCC,IAAAA,YAAY,EAAE,EAFmB;AAGjClC,IAAAA,KAAK,EAAEgB,YAH0B;AAIjCG,IAAAA,MAAM,EAAE,EAJyB;AAKjCgB,IAAAA,KAAK,EAAE,KAL0B;AAMjCC,IAAAA,SAAS,EAAE,KANsB;AAOjCC,IAAAA,WAAW,EAAE,CAAC,CAPmB;AAQjCC,IAAAA,OAAO,EAAE;AARwB,GAAD,CAAlC;AAUA,QAAM;AACJL,IAAAA,IADI;AAEJC,IAAAA,YAFI;AAGJlC,IAAAA,KAHI;AAIJmB,IAAAA,MAJI;AAKJgB,IAAAA,KALI;AAMJC,IAAAA,SANI;AAOJC,IAAAA;AAPI,MAQFN,KARJ;AASA,QAAMQ,MAAM,GAAGnC,OAAO,CAAC,MAAM;AAC3B,QAAIoC,SAAS,GAAG3B,SAAS,CAACb,KAAD,EAAQ,CAAC,GAAG8B,kBAAJ,EAAwB,GAAGI,YAA3B,CAAR,CAAzB;;AAEA,QAAI,CAACM,SAAD,IAAc,CAACd,UAAf,IAA6B,CAACR,QAAlC,EAA4C;AAC1C,OAACsB,SAAD,IAAcV,kBAAd;AACD;;AAED,WAAOU,SAAP;AACD,GARqB,EAQnB,CAACxC,KAAD,EAAQ8B,kBAAR,EAA4BI,YAA5B,EAA0CR,UAA1C,EAAsDR,QAAtD,CARmB,CAAtB;AASA,QAAMI,OAAO,GAAGlB,OAAO,CAAC,MAAMO,YAAY,CAACsB,IAAD,CAAnB,EAA2B,CAACA,IAAD,CAA3B,CAAvB;AACA,QAAMQ,YAAY,GAAGrC,OAAO,CAAC,MAAMK,eAAe,CAAC8B,MAAD,CAAtB,EAAgC,CAACA,MAAD,CAAhC,CAA5B;AACA,QAAMG,MAAM,GAAGnC,WAAW,CAAC,MAAM;AAC/ByB,IAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClER,MAAAA,KAAK,EAAE,KAD2D;AAElEhB,MAAAA,MAAM,EAAE,EAF0D;AAGlEc,MAAAA,IAAI,EAAEH,kBAH4D;AAIlEO,MAAAA,WAAW,EAAE,CAAC;AAJoD,KAAlC,CAA1B,CAAR;;AAOA,QAAIR,GAAG,CAACe,OAAR,EAAiB;AACff,MAAAA,GAAG,CAACe,OAAJ,CAAYC,IAAZ;AACD;AACF,GAXyB,EAWvB,CAACf,kBAAD,EAAqBD,GAArB,CAXuB,CAA1B;;AAaA,QAAMiB,QAAQ,GAAGC,QAAQ,IAAIf,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAC/FR,IAAAA,KAAK,EAAEY;AADwF,GAAlC,CAA1B,CAArC;;AAIA,QAAMC,OAAO,GAAG,MAAMF,QAAQ,CAAC,CAACX,KAAF,CAA9B;;AAEA,QAAMc,OAAO,GAAG,MAAMH,QAAQ,CAAC,IAAD,CAA9B;;AAEA,QAAMI,QAAQ,GAAG3C,WAAW,CAAC4C,EAAE,IAAI;AACjCnB,IAAAA,QAAQ,CAACoB,SAAS,IAAI;AACpB,YAAM;AACJnB,QAAAA,IAAI,EAAEoB,QADF;AAEJhB,QAAAA,WAAW,EAAEiB;AAFT,UAGFF,SAHJ,CADoB,CAIL;;AAEf,YAAMG,IAAI,GAAGJ,EAAE,GAAGE,QAAQ,CAACG,IAAT,CAAcnE,CAAC,IAAIA,CAAC,CAACoE,GAAF,KAAUN,EAA7B,CAAH,GAAsCE,QAAQ,CAACC,eAAD,CAA7D;;AAEA,UAAI,CAACC,IAAL,EAAW;AACT,eAAOH,SAAP;AACD;;AAED,YAAMM,MAAM,GAAG9C,WAAW,CAAC2C,IAAI,CAACvD,KAAN,EAAaoD,SAAS,CAACpD,KAAvB,EAA8BkB,QAA9B,CAA1B;AACA,YAAMyC,UAAU,GAAG9C,SAAS,CAAC6C,MAAD,EAASL,QAAT,CAA5B;AACA,aAAOlE,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKiE,SAAL,CAAd,EAA+B,EAA/B,EAAmC;AACrDlB,QAAAA,YAAY,EAAEhB,QAAQ,GAAGyC,UAAH,GAAgB,CAACA,UAAD,CADe;AAErD3D,QAAAA,KAAK,EAAE0D,MAF8C;AAGrDpB,QAAAA,OAAO,EAAE,CAACoB,MAAD,EAASC,UAAT;AAH4C,OAAnC,CAApB;AAKD,KAnBO,CAAR;AAoBD,GArB2B,EAqBzB,CAACzC,QAAD,CArByB,CAA5B;AAsBA,QAAM0C,WAAW,GAAGrD,WAAW,CAACsD,CAAC,IAAI;AACnC,QAAI,CAAClC,aAAL,EAAoB;AAClBkC,MAAAA,CAAC,CAACC,cAAF;AACD;;AAEDZ,IAAAA,QAAQ,CAACW,CAAC,CAACE,aAAF,CAAgB/D,KAAjB,CAAR;AACD,GAN8B,EAM5B,CAACkD,QAAD,EAAWvB,aAAX,EAA0BT,QAA1B,CAN4B,CAA/B;AAOA,QAAM8C,SAAS,GAAGzD,WAAW,CAACsD,CAAC,IAAI;AACjC,UAAM;AACJnE,MAAAA;AADI,QAEFmE,CAFJ;;AAIA,QAAInE,GAAG,KAAK,WAAR,IAAuBA,GAAG,KAAK,SAAnC,EAA8C;AAC5CmE,MAAAA,CAAC,CAACC,cAAF;AACA9B,MAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClEN,QAAAA,WAAW,EAAE7B,gBAAgB,CAACmC,QAAQ,CAACN,WAAV,EAAuB;AAClD3C,UAAAA,GADkD;AAElD4B,UAAAA,OAAO,EAAEqB,QAAQ,CAACV;AAFgC,SAAvB;AADqC,OAAlC,CAA1B,CAAR;AAMD;AACF,GAd4B,EAc1B,EAd0B,CAA7B;AAeA,QAAMgC,UAAU,GAAG1D,WAAW,CAAC,CAAC;AAC9Bb,IAAAA;AAD8B,GAAD,KAEzB;AACJ,QAAIA,GAAG,KAAK,OAAZ,EAAqB;AACnBwD,MAAAA,QAAQ;;AAER,UAAItB,QAAQ,IAAID,aAAhB,EAA+B;AAC7Be,QAAAA,MAAM;AACP;AACF;AACF,GAV6B,EAU3B,CAACQ,QAAD,EAAWhC,QAAX,EAAqBS,aAArB,EAAoCe,MAApC,CAV2B,CAA9B;AAWA,QAAMwB,OAAO,GAAG3D,WAAW,CAAC,CAAC;AAC3Bb,IAAAA;AAD2B,GAAD,KAEtB;AACJ,QAAIA,GAAG,KAAK,QAAZ,EAAsB;AACpBgD,MAAAA,MAAM;AACP;AACF,GAN0B,EAMxB,CAACA,MAAD,CANwB,CAA3B;;AAQA,QAAMyB,QAAQ,GAAG,CAAC;AAChB/E,IAAAA;AADgB,GAAD,KAEX;AACJ,UAAM;AACJY,MAAAA,KAAK,EAAEoE;AADH,QAEFhF,MAFJ;AAGA,UAAMiF,QAAQ,GAAG;AACflD,MAAAA,MAAM,EAAEiD;AADO,KAAjB;AAGA,QAAIE,gBAAgB,GAAGxC,kBAAvB;;AAEA,QAAIL,UAAU,IAAI2C,QAAQ,CAAC7E,MAA3B,EAAmC;AACjC8E,MAAAA,QAAQ,CAACjC,SAAT,GAAqB,IAArB;AACAkC,MAAAA,gBAAgB,GAAG7C,UAAU,CAAC2C,QAAD,CAA7B;AACD;;AAEDpC,IAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B0B,QAA9B,CAA1B,CAAR;AACAE,IAAAA,OAAO,CAACC,OAAR,CAAgBF,gBAAhB,EAAkCG,IAAlC,CAAuCC,YAAY,IAAI;AACrD,UAAIf,UAAU,GAAGe,YAAjB;;AAEA,UAAIN,QAAQ,CAAC7E,MAAb,EAAqB;AACnBoE,QAAAA,UAAU,GAAG7C,QAAQ,CAACsD,QAAD,EAAWM,YAAX,EAAyBrD,IAAzB,CAArB;AACD;;AAEDW,MAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClEV,QAAAA,IAAI,EAAE0B,UAAU,KAAK,KAAf,GAAuBe,YAAvB,GAAsCf,UADsB;AAElEvB,QAAAA,SAAS,EAAE;AAFuD,OAAlC,CAA1B,CAAR;AAID,KAXD,EAWGuC,KAXH,CAWS,MAAM3C,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AACjFV,MAAAA,IAAI,EAAEH,kBAD2E;AAEjFM,MAAAA,SAAS,EAAE;AAFsE,KAAlC,CAA1B,CAXvB;AAeD,GAhCD;;AAkCA,QAAMwC,UAAU,GAAG;AACjBC,IAAAA,QAAQ,EAAE,GADO;AAEjBC,IAAAA,QAAQ,EAAE,CAAC1D,SAFM;AAGjBI,IAAAA,QAAQ,EAAEJ,SAAS,GAAG+C,QAAH,GAAc,IAHhB;AAIjBlD,IAAAA,QAJiB;AAKjB2C,IAAAA,WAAW,EAAEZ,OALI;AAMjBN,IAAAA,MANiB;AAOjBO,IAAAA,OAPiB;AAQjBgB,IAAAA,UARiB;AASjBD,IAAAA,SATiB;AAUjBE,IAAAA,OAViB;AAWjBrC,IAAAA;AAXiB,GAAnB;AAaA,QAAMkD,WAAW,GAAG3E,OAAO,CAAC,OAAO;AACjCyE,IAAAA,QAAQ,EAAE,IADuB;AAEjCjB,IAAAA,WAFiC;AAGjCI,IAAAA,SAHiC;AAIjCC,IAAAA,UAJiC;AAKjCvB,IAAAA;AALiC,GAAP,CAAD,EAMvB,CAACkB,WAAD,EAAcI,SAAd,EAAyBC,UAAzB,EAAqCvB,MAArC,CANuB,CAA3B;AAOAvC,EAAAA,SAAS,CAAC,MAAM;AACd6B,IAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClE3C,MAAAA,KAAK,EAAEgB;AAD2D,KAAlC,CAA1B,CAAR;AAGD,GAJQ,EAIN,CAACA,YAAD,CAJM,CAAT;AAKAb,EAAAA,SAAS,CAAC,MAAM;AACd6B,IAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClEV,MAAAA,IAAI,EAAEH;AAD4D,KAAlC,CAA1B,CAAR;AAGD,GAJQ,EAIN,CAACA,kBAAD,CAJM,CAAT;AAKA3B,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI4B,KAAK,CAACO,OAAN,KAAkB,KAAtB,EAA6B;AAC3BN,MAAAA,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAClEL,QAAAA,OAAO,EAAE;AADyD,OAAlC,CAA1B,CAAR;AAGAd,MAAAA,QAAQ,CAAC,GAAGO,KAAK,CAACO,OAAV,CAAR;AACD;AACF,GAPQ,EAON,CAACP,KAAK,CAACO,OAAP,EAAgBd,QAAhB,CAPM,CAAT;AAQA,SAAO,CAAC;AACNxB,IAAAA,KAAK,EAAEuC,MADD;AAENF,IAAAA,WAFM;AAGNf,IAAAA,OAHM;AAINL,IAAAA,QAJM;AAKNwB,IAAAA,YALM;AAMNN,IAAAA,KANM;AAONhB,IAAAA,MAPM;AAQNiB,IAAAA;AARM,GAAD,EASJwC,UATI,EASQG,WATR,EASqBC,QAAQ,IAAIhD,QAAQ,CAACW,QAAQ,IAAIxD,aAAa,CAACA,aAAa,CAAC,EAAD,EAAKwD,QAAL,CAAd,EAA8B,EAA9B,EAAkC;AAC1G3C,IAAAA,KAAK,EAAEgF;AADmG,GAAlC,CAA1B,CATzC,CAAP;AAYD","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useEffect, useMemo, useState, useRef, useCallback } from 'react';\nimport highlightReducer from './highlightReducer';\nimport getDisplayValue from './lib/getDisplayValue';\nimport flattenOptions from './lib/flattenOptions';\nimport groupOptions from './lib/groupOptions';\nimport getNewValue from './lib/getNewValue';\nimport getOption from './lib/getOption';\nimport doSearch from './search';\nexport default function useSelectSearch({\n  value: defaultValue = null,\n  disabled = false,\n  multiple = false,\n  search: canSearch = false,\n  fuse = false,\n  options: defaultOptions,\n  onChange = () => {},\n  getOptions = null,\n  allowEmpty = true,\n  closeOnSelect = true,\n  closable = true\n}) {\n  const ref = useRef(null);\n  const flatDefaultOptions = useMemo(() => flattenOptions(defaultOptions), [defaultOptions]);\n  const [state, setState] = useState({\n    flat: [],\n    addedOptions: [],\n    value: defaultValue,\n    search: '',\n    focus: false,\n    searching: false,\n    highlighted: -1,\n    changed: false\n  });\n  const {\n    flat,\n    addedOptions,\n    value,\n    search,\n    focus,\n    searching,\n    highlighted\n  } = state;\n  const option = useMemo(() => {\n    let newOption = getOption(value, [...flatDefaultOptions, ...addedOptions]);\n\n    if (!newOption && !allowEmpty && !multiple) {\n      [newOption] = flatDefaultOptions;\n    }\n\n    return newOption;\n  }, [value, flatDefaultOptions, addedOptions, allowEmpty, multiple]);\n  const options = useMemo(() => groupOptions(flat), [flat]);\n  const displayValue = useMemo(() => getDisplayValue(option), [option]);\n  const onBlur = useCallback(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      focus: false,\n      search: '',\n      flat: flatDefaultOptions,\n      highlighted: -1\n    }));\n\n    if (ref.current) {\n      ref.current.blur();\n    }\n  }, [flatDefaultOptions, ref]);\n\n  const setFocus = newFocus => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    focus: newFocus\n  }));\n\n  const onClick = () => setFocus(!focus);\n\n  const onFocus = () => setFocus(true);\n\n  const onSelect = useCallback(id => {\n    setState(prevState => {\n      const {\n        flat: prevFlat,\n        highlighted: prevHighlighted\n      } = prevState; // eslint-disable-next-line no-underscore-dangle\n\n      const item = id ? prevFlat.find(i => i._id === id) : prevFlat[prevHighlighted];\n\n      if (!item) {\n        return prevState;\n      }\n\n      const values = getNewValue(item.value, prevState.value, multiple);\n      const newOptions = getOption(values, prevFlat);\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        addedOptions: multiple ? newOptions : [newOptions],\n        value: values,\n        changed: [values, newOptions]\n      });\n    });\n  }, [multiple]);\n  const onMouseDown = useCallback(e => {\n    if (!closeOnSelect) {\n      e.preventDefault();\n    }\n\n    onSelect(e.currentTarget.value);\n  }, [onSelect, closeOnSelect, multiple]);\n  const onKeyDown = useCallback(e => {\n    const {\n      key\n    } = e;\n\n    if (key === 'ArrowDown' || key === 'ArrowUp') {\n      e.preventDefault();\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        highlighted: highlightReducer(oldState.highlighted, {\n          key,\n          options: oldState.flat\n        })\n      }));\n    }\n  }, []);\n  const onKeyPress = useCallback(({\n    key\n  }) => {\n    if (key === 'Enter') {\n      onSelect();\n\n      if (closable && closeOnSelect) {\n        onBlur();\n      }\n    }\n  }, [onSelect, multiple, closeOnSelect, onBlur]);\n  const onKeyUp = useCallback(({\n    key\n  }) => {\n    if (key === 'Escape') {\n      onBlur();\n    }\n  }, [onBlur]);\n\n  const onSearch = ({\n    target\n  }) => {\n    const {\n      value: inputVal\n    } = target;\n    const newState = {\n      search: inputVal\n    };\n    let searchableOption = flatDefaultOptions;\n\n    if (getOptions && inputVal.length) {\n      newState.searching = true;\n      searchableOption = getOptions(inputVal);\n    }\n\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), newState));\n    Promise.resolve(searchableOption).then(foundOptions => {\n      let newOptions = foundOptions;\n\n      if (inputVal.length) {\n        newOptions = doSearch(inputVal, foundOptions, fuse);\n      }\n\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        flat: newOptions === false ? foundOptions : newOptions,\n        searching: false\n      }));\n    }).catch(() => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions,\n      searching: false\n    })));\n  };\n\n  const valueProps = {\n    tabIndex: '0',\n    readOnly: !canSearch,\n    onChange: canSearch ? onSearch : null,\n    disabled,\n    onMouseDown: onClick,\n    onBlur,\n    onFocus,\n    onKeyPress,\n    onKeyDown,\n    onKeyUp,\n    ref\n  };\n  const optionProps = useMemo(() => ({\n    tabIndex: '-1',\n    onMouseDown,\n    onKeyDown,\n    onKeyPress,\n    onBlur\n  }), [onMouseDown, onKeyDown, onKeyPress, onBlur]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      value: defaultValue\n    }));\n  }, [defaultValue]);\n  useEffect(() => {\n    setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n      flat: flatDefaultOptions\n    }));\n  }, [flatDefaultOptions]);\n  useEffect(() => {\n    if (state.changed !== false) {\n      setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n        changed: false\n      }));\n      onChange(...state.changed);\n    }\n  }, [state.changed, onChange]);\n  return [{\n    value: option,\n    highlighted,\n    options,\n    disabled,\n    displayValue,\n    focus,\n    search,\n    searching\n  }, valueProps, optionProps, newValue => setState(oldState => _objectSpread(_objectSpread({}, oldState), {}, {\n    value: newValue\n  }))];\n}"]},"metadata":{},"sourceType":"module"}